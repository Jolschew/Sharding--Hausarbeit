## Sharding Grundlagen

### Auswahl des Sharding-Keys
Über den Sharding-Key findet die Verteilung der Datensätze statt. Dieser ist daher maßgeblich für die Effizienz und Effektivität der geshardeten Datenbanken. Vor der Festlegung des Sharding-Keys sollte die Datenbankarchitektur gründlich durchdacht werden. Schlecht gewählte Sharding-Keys zeigen eventuell erst zu einem späteren Zeitpunkt ihre Nachteile auf. In vielen Fällen ist die Datenbankarchitektur dann aber schon so tief in bestehende Systeme verankert, dass eine Veränderungen an ihr kaum oder nur mit erheblichem Aufwand möglich ist. Es ist also sehr ratsam den Verwendungszweck der zu speichernden Daten zu analysieren, zu verstehen und die Nutzung bzw. spätere Datenbankanfragen im Vorfeld möglichst genau zu analysieren und einzuschätzen. Es sollte auch darüber nachgedacht werden Daten erst zu einem späteren Zeitpunkt zu sharden, wenn der Rechenaufwand von Datenbankanfragen besser abgeschätzt werden kann. Es sollte aber hierbei darauf geachtet werden, ob späteres Sharden aufgrund der entwickelten oder zu entwickelnden Architektur und Technologie noch möglich ist.


### Shard Mapping
Bei der Verteilung wird, bereits in früheren Abschnitten erwähnt, die Verteilung anhand der Werte der Sharding-Keys vorgenommen. Hierzu gibt es grundsätzlich zwei verschiedene Varianten. Bei der ersten Variante wird die Verteilung anhand von Intervallen vorgenommen. Das bedeutet, dass die Komponente, die letztendlich über die Verteilung entscheidet, Informationen bekommt, die Aussagen darüber treffen bei Welchem Wert des Shard-Key's zu welchem Datenbankknoten gehört. Diese Intervall könnte bei einer Benutzerdatenbank beispielsweise eine numerische Kundenummer sein. Kunden mit der Nummer 1 bis 10.000 werden entsprechend auf Datenbank A gespeichert und Kunden mit der Nummer > 10.000 auf Datenbank B. Eine weitere Variante ist die Verteilung anhand von Hashwerten. Diese Hashwerte können auf unterschiedlichste Art und Weise generiert werden. Es könnte beispielsweise ein Hashwert aus mehreren Daten eines Benutzers ermittelt werden und die Verteilung dann anhand dessen vorgenommen werden. Verteilungen durch Hashwerte werden häufig von Datenbanksystemen verwendet, die das Sharden von Haus aus bereits mitbringen. Welcher Shard-Wert für den jeweiligen Verwendungszweck am geeignetsten ist hängt jedoch vom Verwendungszweck und vom Grund für das Verteilen der Datensätze ab.


### Welche Datenbanken unterstützen Sharding?
Auf Grund wachsender Komplexität von Software und Webservices werden die Anforderungen an IT-Technologien immer größer. Replikationsmechanismen spielen dabei immer mehr und mehr eine wichtigere Rolle und sind mittlerweile nicht mehr weg zu denken. Da viele der modernen Datenbanktechnologien ohne diese kaum noch Verwendung finden würden, unterstützen mittlerweile sehr viele Datenbanken diese Replikationsmechanismen unabhängig vom Datenbanktyp von Haus aus. Sollte ein Datenbanksystem das Sharden nicht von Haus aus unterstützen, so ist ein eigenes einrichten horizontaler Verteilung von Datensätzen auf mehrere Datenbanksysteme zum Beispiel mittels Verwendung einer Skriptsprache, wie zum Beispiel PHP, möglich aber nicht immer ratsam. In den folgenden Abschnitten soll nun die Implementierung in einigen Datenbanksystemen anhand praktischer Beispiele näher erläutert werden.

### NoSQL und Sharding – Ein attraktiver Verbund [DBE2017]

Einer der Gründe, weswegen die Nutzung von NoSQL Datenbanksystem zunimmt ist, dass diese häufig im Standardumfang bereits implementierte Replikations- und Shardingfeatures haben. In diesen entsprechenden Datenbanksysteme lässt sich das Sharden meist ohne großen Aufwand umsetzen. Grund dafür ist, dass in einer typischen NoSQL Datenbank in der Regel keine Joins unterstützt werden und auch das Zugreifen über Sekundärschlüssel eher eine Ausnahme bleibt. Zugriffe über Sekundärschlüssel oder Joins machen die Effizienz von Sharding zu nichte. Geshardete Datenbanksysteme sind also häufig NoSQL
